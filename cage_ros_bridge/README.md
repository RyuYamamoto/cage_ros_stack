# cage_ros_bridge

ROS とシミュレータを接続する通信プログラムです。

## 購読/配信するもの

### 購読するトピック

+ /cmd_vel  (geometry_msgs::Twist)

### 配信するトピック

+ /odom (nav_msgs::Odometry)
+ /imu  (sensor_msgs::Imu)
+ /fix/gps (sensor_msgs::NavSatFix)

### 配信するTF

+ odom → base_link
+ base_link → IMU
+ base_link → lidar
+ base_link → latlon
+ odom → base_link_gt
+ map → odom

## 配信するデータについて

### オドメトリ

シミュレータから取得した車輪径パラメータを利用し、タイヤ回転数とロボットの角速度を積算して位置姿勢を求める単純な実装です。

### Lidar 位置

シミュレータから取得した lidar 取り付け位置を、base_link と lidar の位置関係のTFとして配信します。なおこの機能は、VTCであれば2020年9月版以降で使えます。

### IMU 位置

Lidar 位置と同様に TF を配信します。ただし、現状のシミュレータは取り付け位置が異なることによる影響は再現しません。

### 地理情報(試験的実装)

ロボットの緯度経度を/fix/gps/に配信します。また接続直後のロボットの方位からmapとodomの変換を配信します。
現状では何らかのGNSS入力を模擬したものではなく、単にシミュレータ内の誤差のないロボット位置を緯度経度の表現で配信しているに過ぎません。参照する場合は注意してください。

なお、これも2020年9月版以降のVTCで使えます。

### レーザスキャンデータ

cage_ros_bridge はレーザスキャンデータは扱いません。VTCシミュレータはロボットにコマンドを送ってきたホストに対し、VLP-16相当のプロトコルでスキャンデータを送信してきますので、別途(実機用と同じ)スキャン受信機を用意してください。

